"use strict";(self.webpackChunkcse335=self.webpackChunkcse335||[]).push([[530],{79068:(t,e,i)=>{i.d(e,{Z9:()=>b.Z});var n=i(83018),r={namespaced:!0,state:{user:null},mutations:{set:function(t,e){e instanceof n.n?t.user=e:t.user=new n.n(e)}}},s=i(15592),o=function(){};o.create=function(t,e){return{namespaced:!0,state:{users:[],fetcher:new s.H,query:{}},mutations:{add:function(t,e){t.users.push(e)},more:function(t,e){t.fetcher.more=e},fetchStart:function(t,e){t.fetcher.start(e)},fetchDone:function(t,e){t.fetcher.done(e)},reset:function(t,e){t.fetcher.reset(),t.users=[]},query:function(t,e){t.query=e},update:function(t,i){if(t.fetcher.fetched){if(0===t.users.length)return t.fetcher.reset(),void(t.users=[]);for(var r=0;r<t.users.length;r++)if(e(i)===e(t.users[r]))return t.users[r]=i,t.fetcher.more&&n.n.compare(i,t.users[t.users.length-1])>=0?(t.fetcher.reset(),void(t.users=[])):void t.users.sort(n.n.compare);t.fetcher.more=!0}},new:function(t,e){if(t.fetcher.fetched)if(0!==t.users.length){if(!t.fetcher.more)return t.users.push(e),void t.users.sort(n.n.compare);if(n.n.compare(e,t.users[t.users.length-1])>=0)return t.fetcher.reset(),void(t.users=[]);t.users.push(e),t.users.sort(n.n.compare)}else t.users.push(e)},delete:function(t,i){for(var n=0;n<t.users.length;n++)if(e(t.users[n])===i){t.users.splice(n,1);break}}},actions:{fetch:function(t){var e=t.dispatch;t.state.fetcher.fetched||e("more")},more:function(e){var i=this,n=e.commit,r=e.state;if(!r.fetcher.fetched||r.fetcher.more){n("fetchStart");var s={limit:500,offset:r.users.length};Object.assign(s,r.query),Site.api.get(t,s).then((function(t){if(t.hasError())console.log(t),Site.toast(i,t);else{var e=t.getData("users");if(null!==e){var r=!1;e.attributes.forEach((function(t){"yes"===t.more?r=!0:n("add",new Site.User(t))})),n("more",r),n("fetchDone")}}})).catch((function(t){console.log(t),Site.toast(i,t)}))}},get:function(e,i){var n=this,r=e.commit;e.state;return new Promise((function(e,s){r("fetchStart",!0),i.prevnext=1,Site.api.get(t,i).then((function(t){if(t.hasError())console.log(t),Site.toast(n,t);else{var i=t.getData("users");if(null!==i)if(i.attributes.length<1)s("User does not exist");else{r("fetchDone",!0);var o=new Site.User(i.attributes[0]),a=t.getData("prev-user");null!==a&&(o.prev=new Site.User(a.attributes));var u=t.getData("next-user");null!==u&&(o.next=new Site.User(u.attributes)),e(o)}}})).catch((function(t){console.log(t),Site.toast(n,t)}))}))},update:function(e,i){var n=this,r=e.commit;e.state;return new Promise((function(e,s){Site.api.post(t+"/update",i).then((function(t){if(t.hasError())s(t);else{var i=t.getData("updated-user"),n=new Site.User(i.attributes);r("update",n),e(n)}})).catch((function(t){Site.toast(n,t)}))}))},new:function(e,i){var n=this,r=e.commit;e.state;return new Promise((function(e,s){Site.api.post(t+"/new",i).then((function(t){if(t.hasError())console.log("reject"),s(t);else{var i=t.getData("new-user"),n=new Site.User(i.attributes);r("new",n),e(n)}})).catch((function(t){Site.toast(n,t)}))}))},delete:function(e,i){var n=this,r=e.commit;e.state;return new Promise((function(e,s){Site.api.post(t+"/delete",{id:i.id}).then((function(t){t.hasError()?(console.log(t),Site.toast(n,t)):(r("delete",i.id),e())})).catch((function(t){console.log(t),Site.toast(n,t)}))}))}}}};var a=function(t){this.permissions=t,this.atLeast=function(t,e){return void 0!==this.permissions[t]?this.permissions[t]:e}},u=i(66759),l={class:"content cl-about-me"},c={class:"full"},d={class:"small"},h=(0,u._)("tr",null,[(0,u._)("th",null," "),(0,u._)("th",null," "),(0,u._)("th",null," ")],-1),f=["innerHTML"],v={key:1},m={key:0,class:"center"},p={key:1,class:"center"},g=(0,u._)("button",{type:"submit"},"Submit",-1);var y=i(75560),b=i(44687);function w(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return S(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var k=Site.MaskVue;const U={extends:b.Z,props:["json"],data:function(){return{prefData:[],editing:!1,mask:!1}},components:{maskVue:k},mounted:function(){this.setTitle("About "+this.user.displayName()),this.prefData=this.json},methods:{edit:function(){this.editing=!0},cancel:function(){this.editing=!1},submit:function(){var t,e=this,i={},n=w(this.prefData);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(null!==r.editor){var s=document.getElementById(r.tag);if(null!==s){var o=s.value;if(i[r.tag]=o,"email"===r.type&&!this.validEmail(o))return void new y.Z.MessageBox("Invalid Email!","Must provide a valid email address.",y.Z.MessageBox.OK,(function(){}))}}}}catch(t){n.e(t)}finally{n.f()}this.mask=!0,this.$site.api.post("/api/users/aboutme",i).then((function(t){if(e.mask=!1,t.hasError())e.$site.toast(e,t);else{e.prefData=t.getData("preferences-data").attributes;var i=new Site.User(t.getData("user").attributes);e.$store.commit("user/set",i),e.editing=!1}})).catch((function(t){e.mask=!1,e.$site.toast(e,t)}))},validEmail:function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},value:function(t){return"password"===t.type?""===t.value||null===t.value?"":"********":t.value}}};var D=i(54571),_=i.n(D),x=i(50063),M=i.n(x),E=i(14971),Z=i.n(E),A=i(78446),I=i.n(A),T=i(71984),q=i.n(T),C=i(63641),R=i.n(C),F=i(59008),O={};O.styleTagTransform=R(),O.setAttributes=I(),O.insert=Z().bind(null,"head"),O.domAPI=M(),O.insertStyleElement=q();_()(F.Z,O);F.Z&&F.Z.locals&&F.Z.locals;var P=i(87619);const N=(0,P.Z)(U,[["render",function(t,e,i,n,r,s){var o=(0,u.up)("mask-vue");return(0,u.wg)(),(0,u.iD)("div",l,[(0,u._)("div",c,[(0,u.Wm)(o,{mask:t.mask},{default:(0,u.w5)((function(){return[(0,u.Uk)("Communicating with server...")]})),_:1},8,["mask"]),(0,u._)("form",{method:"post",onSubmit:e[2]||(e[2]=(0,u.iM)((function(){return s.submit&&s.submit.apply(s,arguments)}),["prevent"]))},[(0,u._)("table",d,[h,((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(t.prefData,(function(e){return(0,u.wg)(),(0,u.iD)("tr",null,[(0,u._)("td",null,(0,u.zw)(e.desc),1),t.editing&&null!==e.editor?((0,u.wg)(),(0,u.iD)("td",{key:0,innerHTML:e.editor},null,8,f)):((0,u.wg)(),(0,u.iD)("td",v,(0,u.zw)(s.value(e)),1)),(0,u._)("td",null,(0,u.zw)(e.comment),1)])})),256))]),t.editing?((0,u.wg)(),(0,u.iD)("p",p,[g,(0,u.Uk)(),(0,u._)("button",{onClick:e[1]||(e[1]=(0,u.iM)((function(){return s.cancel&&s.cancel.apply(s,arguments)}),["prevent"]))},"Cancel")])):((0,u.wg)(),(0,u.iD)("p",m,[(0,u._)("button",{onClick:e[0]||(e[0]=(0,u.iM)((function(){return s.edit&&s.edit.apply(s,arguments)}),["prevent"]))},"Edit")]))],32)])])}]]);var V=function(){};V.create=function(t){var e=function(){};e.MUST_PROVIDE_USERID_OR_EMAIL=101,e.PASSWORDS_MUST_MATCH=102,e.DUPLICATE_USER=103,e.DUPLICATE_EMAIL=104;var i=t.store;return void 0!==i&&(i.registerModule("user",r),i.registerModule("users",o.create("/api/users",(function(t){return t.id})))),t.ready((function(){var e;null!==(e=document.getElementById("cl-user"))&&i.commit("user/set",JSON.parse(e.textContent)),null!==(e=document.getElementById("cl-permissions"))&&(t.permissions=new a(JSON.parse(e.textContent))),t.PageVue.create("div.cl-users-aboutme","Example Vue",N,t.PageNav)})),t.UserVueBase=b.Z,t.User=n.n,t.StoreModuleUsers=o,e};var L={class:"cl-input"},j=["src"],z={key:0,class:"cl-results"},B={class:"cl-result-list"},$=["onClick"],H=["onClick"],G=["onClick"],J={key:0,class:"statement"},K={key:1,class:"statement"},W=["src"];const Y={props:["selected"],data:function(){return{query:"",result:[],noresult:!1,seq:1,fetched:!1,timer:null,set:!1,more:!1,root:Site.root}},watch:{query:function(t,e){var i=this;this.set?this.set=!1:(null!==this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){i.fetch(t)}),300))}},methods:{fetch:function(t){var e=this;if(null!==this.timer&&(clearTimeout(this.timer),this.timer=null),this.selected(null),(t=t.trim()).length<2)return this.fetched=!1,void(this.result=[]);this.seq++,Site.api.get("/api/users",{search:t,seq:this.seq,limit:20}).then((function(t){if(t.hasError())Site.toast(e,t);else{if(+t.getData("seq").id!==e.seq)return;var i=t.getData("users");null!==i&&(e.result=[],e.more=!1,i.attributes.forEach((function(t){if("yes"!==t.more){var i=new Site.User(t);e.result.push(i)}else e.more=!0})),e.noresult=0===e.result.length)}})).catch((function(t){console.log(t),Site.toast(e,t)}))},selectUser:function(t){this.query=t.name,this.set=!0,this.result=[],this.noresult=!1,this.more=!1,this.selected(t)},clear:function(){this.seq++,this.result=[],this.noresult=!1,this.more=!1,this.query="",this.selected(null)}}};var Q=i(5591),X={};X.styleTagTransform=R(),X.setAttributes=I(),X.insert=Z().bind(null,"head"),X.domAPI=M(),X.insertStyleElement=q();_()(Q.Z,X);Q.Z&&Q.Z.locals&&Q.Z.locals;const tt=(0,P.Z)(Y,[["render",function(t,e,i,n,r,s){return(0,u.wg)(),(0,u.iD)("span",null,[(0,u._)("div",L,[(0,u.wy)((0,u._)("input",{"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.query=e}),type:"text",maxlength:"150"},null,512),[[u.nr,t.query]]),(0,u._)("a",{onClick:e[1]||(e[1]=(0,u.iM)((function(e){return s.fetch(t.query)}),["prevent"])),class:"searcher"},[(0,u._)("img",{src:t.root+"/cl/img/search.png"},null,8,j)]),t.result.length>0||t.noresult?((0,u.wg)(),(0,u.iD)("div",z,[(0,u._)("div",B,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(t.result,(function(t){return(0,u.wg)(),(0,u.iD)("div",{onClick:(0,u.iM)((function(e){return s.selectUser(t)}),["prevent"])},[(0,u._)("span",null,[(0,u._)("a",{onClick:(0,u.iM)((function(e){return s.selectUser(t)}),["prevent"])},(0,u.zw)(t.userId),9,H)]),(0,u._)("span",null,[(0,u._)("a",{onClick:(0,u.iM)((function(e){return s.selectUser(t)}),["prevent"])},(0,u.zw)(t.name),9,G)])],8,$)})),256))]),t.noresult?((0,u.wg)(),(0,u.iD)("div",J,"No results...")):(0,u.kq)("v-if",!0),t.more?((0,u.wg)(),(0,u.iD)("div",K,"...more...")):(0,u.kq)("v-if",!0)])):(0,u.kq)("v-if",!0)]),(0,u.Uk)(),(0,u._)("a",{onClick:e[2]||(e[2]=(0,u.iM)((function(){return s.clear&&s.clear.apply(s,arguments)}),["prevent"]))},[(0,u._)("img",{src:t.root+"/cl/img/x.png"},null,8,W)])])}],["__scopeId","data-v-db3e0532"]]);if(!Site.Users){var et=V.create(Site);Site.FetcherVue=s.Z,Site.Users=et,Site.User=n.n,Site.UserVueBase=b.Z,Site.UserSelectorVue=tt}},83018:(t,e,i)=>{i.d(e,{n:()=>n});var n=function t(e){var i="G",n=null;void 0!==e?("string"==typeof e&&(e=JSON.parse(e)),this.id=e.id,i=e.role,this.name=e.name,this.email=e.email,this.userId=e.user,null!==(n=t.instantiateMember(e))&&(n.user=this)):(this.id=0,i="G",this.name="",this.email="",this.userId=""),Object.defineProperty(this,"member",{get:function(){return n}}),this.role=function(){return null!==n?n.role():i},this.setUserRole=function(t){i=t},this.userRole=function(){return i},this.setMember=function(t){null!==(n=t)&&(n.user=this)}};n.GUEST="G",n.USER="U",n.STAFF="S",n.ADMIN="A",n.getUserRoles=function(){var t={};return t[n.GUEST]={name:"Guest",priority:1},t[n.USER]={name:"User",priority:2},t[n.STAFF]={name:"Staff",priority:3},t[n.ADMIN]={name:"Admin",priority:4},t},n.prototype.getUserRoles=function(){return n.getUserRoles()},n.prototype.getRoles=function(){var t=this.member;return null!==t?t.getRoles():n.getUserRoles()},n.prototype.atLeast=function(t){var e=this.role(),i=this.getRoles();return!!i.hasOwnProperty(t)&&i[e].priority>=i[t].priority},n.prototype.getRolePriority=function(t){var e=this.getRoles();return e.hasOwnProperty(t)?e[t].priority:0},n.prototype.displayName=function(){var t=this.name.indexOf(",");if(t<0)return this.name;var e=this.name.substr(0,t);return this.name.substr(t+1).trim()+" "+e},n.prototype.userRoleName=function(t){var e=this.getUserRoles()[this.userRole()];return void 0===e?"Invalid":!0===t&&void 0!==e.short?e.short:e.name},n.prototype.roleName=function(t){var e=this.getRoles()[this.role()];return void 0===e?"Invalid":!0===t&&void 0!==e.short?e.short:e.name},n.prototype.roleToName=function(t,e){var i=this.getRoles()[t];return void 0===i?"Invalid":!0===e&&void 0!==i.short?i.short:i.name},n.compare=function(t,e){var i=t.name.toLowerCase(),n=e.name.toLowerCase();return i<n?-1:i>n?1:t.id-e.id},n.instantiateMember=function(t){return null}},59008:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(47289),r=i.n(n),s=i(38306),o=i.n(s)()(r());o.push([t.id,"div.cl-about-me table tr td:nth-child(2){min-width:195px}div.cl-about-me button{width:7em}div.cl-about-me input{width:100%}",""]);const a=o},71265:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(47289),r=i.n(n),s=i(38306),o=i.n(s)()(r());o.push([t.id,"div.fetching[data-v-1f3022ac]{height:28px;margin:1em 0}div.fetching p[data-v-1f3022ac]{text-align:center;font-style:italic;color:#c41425;padding-top:2px}.more[data-v-1f3022ac]{text-align:center}.more button[data-v-1f3022ac]{font-size:.8em;height:28px;margin:0}",""]);const a=o},5591:(t,e,i)=>{i.d(e,{Z:()=>a});var n=i(47289),r=i.n(n),s=i(38306),o=i.n(s)()(r());o.push([t.id,"a.searcher[data-v-db3e0532]{position:absolute;top:0;right:0;height:100%;min-height:100%;width:21px;text-align:center;background:#aaa}a.searcher img[data-v-db3e0532]{height:16px;width:16px;vertical-align:-4px}div.cl-input[data-v-db3e0532]{display:inline-block;position:relative;width:300px}div.cl-input input[data-v-db3e0532]{width:100%;border:1px solid #ccc}div.cl-input div.cl-results[data-v-db3e0532]{position:absolute;left:0;right:0;top:100%;overflow:hidden;font-size:.85em;background:#fff;border-left:1px solid #000;border-right:1px solid #000;border-bottom:1px solid #000}div.cl-input div.cl-results div.cl-result-list[data-v-db3e0532]{display:table;width:100%}div.cl-input div.cl-results div.cl-result-list div[data-v-db3e0532]{display:table-row;border-bottom:1px solid #888;cursor:pointer}div.cl-input div.cl-results div.cl-result-list div span[data-v-db3e0532]{display:table-cell;white-space:nowrap;text-align:left;padding:.5em .25em}div.cl-input div.cl-results div.cl-result-list div span a[data-v-db3e0532]{text-decoration:none;color:#000}div.cl-input div.cl-results div.cl-result-list div span a[data-v-db3e0532]:hover{color:#888}div.cl-input div.cl-results div.cl-result-list div span[data-v-db3e0532]:first-child{font-style:italic}div.cl-input div.cl-results div.cl-result-list div span[data-v-db3e0532]:last-child{overflow:hidden;width:99%}div.cl-input div.cl-results div.cl-result-list div:first-child span[data-v-db3e0532],div.cl-input div.cl-results div.cl-result-list div:last-child span[data-v-db3e0532]{padding:.25em .25em}div.cl-input div.cl-results div.statement[data-v-db3e0532]{width:100%;text-align:center;font-style:italic}",""]);const a=o},15592:(t,e,i)=>{i.d(e,{H:()=>a,Z:()=>U});var n=i(66759),r={key:0,class:"fetching"},s=[function(t){return(0,n.dD)("data-v-1f3022ac"),t=t(),(0,n.Cn)(),t}((function(){return(0,n._)("p",null,"Fetching from server...",-1)}))],o={key:2,class:"more"};var a=function(){this.more=!1,this.fetching=!1,this.fetched=!1,this.start=function(t){this.fetching=!0,!0!==t&&(this.more=!1)},this.done=function(t){this.fetching=!1,!0!==t&&(this.fetched=!0)},this.reset=function(){this.more=!1,this.fetching=!1,this.fetched=!1}};const u={props:{fetcher:{type:Object,default:null},fetching:{type:Boolean,default:!1}},watch:{"fetcher.fetching":function(t,e){this.setFetching()},fetching:function(t,e){this.setFetching()}},data:function(){return{showFetching:!1,delayedFetching:!1,timer:null}},mounted:function(){this.setFetching()},methods:{fetchMore:function(){this.$parent.fetchMore()},setFetching:function(){var t=this,e=null!==this.fetcher&&this.fetcher.fetching||this.fetching;e&&!this.showFetching?this.timer=setTimeout((function(){t.delayedFetching=!0}),1e3):!e&&this.showFetching&&(clearTimeout(this.timer),this.time=null,this.delayedFetching=!1),this.showFetching=e}}};var l=i(54571),c=i.n(l),d=i(50063),h=i.n(d),f=i(14971),v=i.n(f),m=i(78446),p=i.n(m),g=i(71984),y=i.n(g),b=i(63641),w=i.n(b),S=i(71265),k={};k.styleTagTransform=w(),k.setAttributes=p(),k.insert=v().bind(null,"head"),k.domAPI=h(),k.insertStyleElement=y();c()(S.Z,k);S.Z&&S.Z.locals&&S.Z.locals;const U=(0,i(87619).Z)(u,[["render",function(t,e,i,a,u,l){return(0,n.wg)(),(0,n.iD)("div",null,[t.delayedFetching?((0,n.wg)(),(0,n.iD)("div",r,s)):(0,n.kq)("v-if",!0),null!==i.fetcher&&i.fetcher.fetching||i.fetching?(0,n.kq)("v-if",!0):(0,n.WI)(t.$slots,"default",{key:1},void 0,!0),null!==i.fetcher&&i.fetcher.more?((0,n.wg)(),(0,n.iD)("p",o,[(0,n._)("button",{onClick:e[0]||(e[0]=(0,n.iM)((function(){return l.fetchMore&&l.fetchMore.apply(l,arguments)}),["prevent"]))},"MORE")])):(0,n.kq)("v-if",!0)])}],["__scopeId","data-v-1f3022ac"]])},44687:(t,e,i)=>{i.d(e,{Z:()=>n});const n={extends:Site.Site.PageVueBase,computed:{user:function(){return this.$store.state.user.user}}}}},t=>{t.O(0,[592],(()=>{return e=79068,t(t.s=e);var e}));t.O()}]);